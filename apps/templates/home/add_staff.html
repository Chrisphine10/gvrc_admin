{% extends 'layouts/base.html' %}

{% block title %}Add Staff Member - GVRC Admin{% endblock %}

{% block content %}
<div class="header bg-info pb-6">
  <div class="container-fluid">
    <div class="header-body">
      <div class="row align-items-center py-4">
        <div class="col-lg-6 col-7">
          <h6 class="h2 text-white d-inline-block mb-0">Add Staff Member</h6>
          <nav aria-label="breadcrumb" class="d-none d-md-inline-block ml-md-4">
            <ol class="breadcrumb breadcrumb-links breadcrumb-dark">
              <li class="breadcrumb-item"><a href="/"><i class="fas fa-home"></i></a></li>
              <li class="breadcrumb-item"><a href="/human-resources/">Human Resources</a></li>
              <li class="breadcrumb-item active" aria-current="page">Add Staff</li>
            </ol>
          </nav>
        </div>
        <div class="col-lg-6 col-5 text-right">
          <a href="/human-resources/" class="btn btn-sm btn-neutral">
            <i class="fas fa-list"></i> View All
          </a>
          <a href="/admin/facilities/facility_humanresources/" class="btn btn-sm btn-neutral">
            <i class="fas fa-cog"></i> Admin Panel
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Page content -->
<div class="container-fluid mt--6">
  <div class="row">
    <div class="col">
      <div class="card">
        <!-- Card header -->
        <div class="card-header border-0">
          <div class="row align-items-center">
            <div class="col">
              <h3 class="mb-0">Add New Staff Member</h3>
              <p class="text-sm text-muted mb-0">
                Fill in the details below to register a new staff member
              </p>
            </div>
          </div>
        </div>

        <!-- Toast Notifications -->
        {% if toast_type and toast_message %}
        <div class="card-header border-0 bg-light">
          <div class="alert alert-{{ toast_type }} alert-dismissible fade show" role="alert">
            <span class="alert-icon"><i class="fas fa-{% if toast_type == 'success' %}check-circle{% else %}exclamation-triangle{% endif %}"></i></span>
            <span class="alert-text">{{ toast_message }}</span>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
        </div>
        {% endif %}

        <!-- Form -->
        <div class="card-body">
          <form method="post">
            {% csrf_token %}
            
            <!-- Personal Information -->
            <h6 class="heading-small text-muted mb-4">Personal Information</h6>
            <div class="pl-lg-4">
              <div class="row">
                <div class="col-lg-6">
                  <div class="form-group">
                    <label class="form-control-label" for="full_name">Full Name *</label>
                    <input type="text" id="full_name" name="full_name" class="form-control {% if errors %}is-invalid{% endif %}" 
                           placeholder="Enter full name" 
                           value="{{ form_data.full_name|default:'' }}" required>
                    {% if errors %}
                    <div class="invalid-feedback">
                      {% for error in errors %}
                        {% if 'name' in error or 'Full name' in error %}{{ error }}{% endif %}
                      {% endfor %}
                    </div>
                    {% endif %}
                  </div>
                </div>
                <div class="col-lg-6">
                  <div class="form-group">
                    <label class="form-control-label" for="position">Position *</label>
                    <input type="text" id="position" name="position" class="form-control {% if errors %}is-invalid{% endif %}" 
                           placeholder="Enter position/title" 
                           value="{{ form_data.position|default:'' }}" required>
                    {% if errors %}
                    <div class="invalid-feedback">
                      {% for error in errors %}
                        {% if 'position' in error or 'Position' in error %}{{ error }}{% endif %}
                      {% endfor %}
                    </div>
                    {% endif %}
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-lg-6">
                  <div class="form-group">
                    <label class="form-control-label" for="staff_category">Staff Category *</label>
                    <select id="staff_category" name="staff_category" class="form-control {% if errors %}is-invalid{% endif %}" required>
                      <option value="">Select staff category</option>
                      {% for value, label in staff_categories %}
                      <option value="{{ value }}" {% if form_data.staff_category == value %}selected{% endif %}>{{ label }}</option>
                      {% endfor %}
                    </select>
                    {% if errors %}
                    <div class="invalid-feedback">
                      {% for error in errors %}
                        {% if 'category' in error or 'Staff category' in error %}{{ error }}{% endif %}
                      {% endfor %}
                    </div>
                    {% endif %}
                  </div>
                </div>
                <div class="col-lg-6">
                  <div class="form-group">
                    <label class="form-control-label" for="facility">Facility *</label>
                    <select id="facility" name="facility" class="form-control {% if errors %}is-invalid{% endif %}" required>
                      <option value="">Select facility</option>
                      {% for facility in facilities %}
                      <option value="{{ facility.id }}" {% if form_data.facility == facility.id|stringformat:"s" %}selected{% endif %}>
                        {{ facility.name }} - {{ facility.get_facility_type_display }}
                      </option>
                      {% endfor %}
                    </select>
                    {% if errors %}
                    <div class="invalid-feedback">
                      {% for error in errors %}
                        {% if 'facility' in error or 'Facility' in error %}{{ error }}{% endif %}
                      {% endfor %}
                    </div>
                    {% endif %}
                  </div>
                </div>
              </div>
            </div>

            <hr class="my-4" />

            <!-- Professional Information -->
            <h6 class="heading-small text-muted mb-4">Professional Information</h6>
            <div class="pl-lg-4">
              <div class="row">
                <div class="col-lg-6">
                  <div class="form-group">
                    <label class="form-control-label" for="qualification">Qualification</label>
                    <input type="text" id="qualification" name="qualification" class="form-control" 
                           placeholder="Enter qualification/degree" 
                           value="{{ form_data.qualification|default:'' }}">
                  </div>
                </div>
                <div class="col-lg-6">
                  <div class="form-group">
                    <label class="form-control-label" for="license_number">License Number</label>
                    <input type="text" id="license_number" name="license_number" class="form-control" 
                           placeholder="Enter professional license number" 
                           value="{{ form_data.license_number|default:'' }}">
                  </div>
                </div>
              </div>
            </div>

            <hr class="my-4" />

            <!-- Contact Information -->
            <h6 class="heading-small text-muted mb-4">Contact Information</h6>
            <div class="pl-lg-4">
              <div class="row">
                <div class="col-lg-6">
                  <div class="form-group">
                    <label class="form-control-label" for="phone">Phone Number</label>
                    <input type="tel" id="phone" name="phone" class="form-control" 
                           placeholder="Enter phone number" 
                           value="{{ form_data.phone|default:'' }}">
                  </div>
                </div>
                <div class="col-lg-6">
                  <div class="form-group">
                    <label class="form-control-label" for="email">Email Address</label>
                    <input type="email" id="email" name="email" class="form-control" 
                           placeholder="Enter email address" 
                           value="{{ form_data.email|default:'' }}">
                  </div>
                </div>
              </div>
            </div>

            <hr class="my-4" />

            <!-- Status -->
            <h6 class="heading-small text-muted mb-4">Status</h6>
            <div class="pl-lg-4">
              <div class="row">
                <div class="col-lg-6">
                  <div class="form-group">
                    <label class="form-control-label" for="is_active">Staff Status</label>
                    <div class="custom-control custom-switch">
                      <input type="checkbox" class="custom-control-input" id="is_active" name="is_active" 
                             {% if form_data.is_active %}checked{% endif %}>
                      <label class="custom-control-label" for="is_active">Staff member is active</label>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <hr class="my-4" />

            <!-- Form Actions -->
            <div class="pl-lg-4">
              <div class="row">
                <div class="col-md-12">
                  <div class="form-group">
                    <button type="submit" class="btn btn-info">
                      <i class="fas fa-save"></i> Create Staff Member
                    </button>
                    <a href="/human-resources/" class="btn btn-secondary">
                      <i class="fas fa-times"></i> Cancel
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block javascripts %}
<script>
// Auto-hide toast notifications after 5 seconds
document.addEventListener('DOMContentLoaded', function() {
    const alerts = document.querySelectorAll('.alert');
    alerts.forEach(function(alert) {
        setTimeout(function() {
            if (alert.parentNode) {
                alert.parentNode.removeChild(alert);
            }
        }, 5000);
    });
});
</script>
{% endblock %}
